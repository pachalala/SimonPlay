<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <!-- polyfill -->
    <script src="../inc/shim/Base64.js" type="text/javascript"></script>
    <script src="../inc/shim/Base64binary.js" type="text/javascript"></script>
    <script src="../inc/shim/WebAudioAPI.js" type="text/javascript"></script>
    <!-- midi.js package -->
    <script src="../js/midi/audioDetect.js" type="text/javascript"></script>
    <script src="../js/midi/gm.js" type="text/javascript"></script>
    <script src="../js/midi/loader.js" type="text/javascript"></script>
    <script src="../js/midi/plugin.audiotag.js" type="text/javascript"></script>
    <script src="../js/midi/plugin.webaudio.js" type="text/javascript"></script>
    <script src="../js/midi/plugin.webmidi.js" type="text/javascript"></script>
    <!-- utils -->
    <script src="../js/util/dom_request_xhr.js" type="text/javascript"></script>
    <script
      src="../js/util/dom_request_script.js"
      type="text/javascript"
    ></script>

    <style>
      #piano {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
      }

      .key {
        border: 1px solid #000;
        height: 200px;
        width: 60px;
        margin: 5px;
      }

      .white {
        background-color: white;
      }

      .black {
        background-color: black;
        width: 40px;
        height: 120px;
        margin-left: -20px;
        margin-right: -20px;
        z-index: 1;
      }
    </style>
  </head>
  <body>
    <script type="text/javascript">
      function playNotes() {
        // Cargar el plugin de MIDI.js con un SoundFont de piano acústico
        MIDI.loadPlugin({
          soundfontUrl: "./soundfont/",
          instrument: "acoustic_grand_piano",
          onsuccess: function () {
            // Configurar el canal 0 para usar el piano acústico
            MIDI.programChange(
              0,
              MIDI.GM.byName["acoustic_grand_piano"].number
            );

            // Reproducir algunas notas (nota, canal, velocidad, retardo)
            MIDI.noteOn(0, 60, 127, 0); // C4
            MIDI.noteOn(0, 64, 127, 0.5); // E4
            MIDI.noteOn(0, 67, 127, 1); // G4

            // Apagar las notas después de un breve tiempo
            MIDI.noteOff(0, 60, 1.5);
            MIDI.noteOff(0, 64, 2);
            MIDI.noteOff(0, 67, 2.5);
          },
        });
      }

      function playNota(nota) {
        console.log("apreto :" + nota);
      }

      const keys = [
        {
          key: "q",
          nota: "C",
		  midi: "123"
        } ,
        {
          key: "w",
          nota: "D",
		  midi: "123"
        },
     
		
		{
          key: "e",
          nota: "E",
		  midi: "123"
        },

		{
          key: "r",
          nota: "F",
		  midi: "123"
        },

		{
          key: "t",
          nota: "G",
		  midi: "123"
        },

		{
          key: "y",
          nota: "A",
		  midi: "123"
        },
		
		{
          key: "u",
          nota: "B",
		  midi: "123"
        },
		
		{
          key: "i",
          nota: "C",
		  midi: "123"
        },
		{
          key: "o",
          nota: "D",
		  midi: "123"
        },
		{
          key: "p",
          nota: "E",
		  midi: "123"
        },
		

		{
          key: "3",
          nota: "F",
		  midi: "123"
        },
        


      ];
    </script>

    <button onclick="playNotes()">Play Notes</button>

    <div id="piano">
      <div data-key="q" class="key white" onclick="playNota('D')"></div>
      <div data-key="2" class="key black"></div>
      <div data-key="w" class="key white"></div>
      <div data-key="3" class="key black"></div>
      <div data-key="e" class="key white"></div>
      <div data-key="r" class="key white"></div>
      <div data-key="5" class="key black"></div>
      <div data-key="t" class="key white"></div>
      <div data-key="6" class="key black"></div>
      <div data-key="y" class="key white"></div>
      <div data-key="7" class="key black"></div>
      <div data-key="u" class="key white"></div>
      <div data-key="i" class="key white"></div>
      <div data-key="9" class="key black"></div>
      <div data-key="o" class="key white"></div>
      <div data-key="0" class="key black"></div>
      <div data-key="p" class="key white"></div>
    </div>

    <script>
      /*
window.addEventListener("keydown", function(event) {
    // Mostrar en consola cuál tecla fue presionada
    console.log("Tecla presionada:", event.key);
    // También puedes acceder a `event.keyCode` si necesitas el código de la tecla (menos recomendado en las nuevas aplicaciones)
});
*/

      window.addEventListener("keydown", function (event) {
        const key = event.key; // Asegurarse de que funciona con mayúsculas

        console.log(`Tecla presionada: ${key.toUpperCase()}`);

        const pianoKey = document.querySelector(`div[data-key="${key}"]`);
        if (pianoKey) {
          console.log(`Tecla presionada: ${key.toUpperCase()}`);
          // Aquí puedes agregar lógica adicional, como tocar un sonido.
        }
      });
    </script>
  </body>
</html>
